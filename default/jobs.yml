in_island_browser_audit:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: "*/5 * * * *"
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: 60m
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking:
        stateUpdateExpression: "__timestampExtracted !== false && {latestTime:
          (state.latestTime || 0) > _time ? state.latestTime : _time}"
        stateMergeExpression: "(prevState.latestTime || 0) > newState.latestTime ?
          prevState : newState"
        enabled: true
    enabled: false
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
      collectMethod: get
      pagination:
        type: request_offset
        offsetField: offset
        limitField: limit
        limit: 100
        maxPages: 50
        zeroIndexed: false
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: false
      decodeUrl: false
      rejectUnauthorized: true
      captureHeaders: false
      stopOnEmptyResults: true
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      collectUrl: "`${C.vars['island_browser_api_base_url']}/external/v1/timeline`"
      collectRequestHeaders:
        - name: Api-Key
          value: "`${C.vars['island_browser_api_key']}`"
      collectRequestParams:
        - name: Start
          value: "`${new Date(state.latestTime*1000 || earliest*1000 || (Date.now() -
            (1000*3600*24*7))).toISOString()}`"
        - name: End
          value: "`${new Date(Date.now()).toISOString()}`"
    destructive: false
    encoding: utf8
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    metadata:
      - name: __packsource
        value: "'cribl-island-browser-rest-io.audit'"
      - name: sourcetype
        value: "'island:browser:audit'"
    breakerRulesets:
      - Island Browser API Ruleset
  savedState: {}
  notifications: []
in_island_browser_devices:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule: {}
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
      collectMethod: post_with_body
      pagination:
        type: request_offset
        offsetField: offset
        limitField: limit
        limit: 100
        maxPages: 50
        zeroIndexed: false
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: false
      decodeUrl: false
      rejectUnauthorized: true
      captureHeaders: false
      stopOnEmptyResults: true
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      collectUrl: "`${C.vars['island_browser_api_base_url']}/external/v1/devices`"
      collectRequestHeaders:
        - name: Api-Key
          value: "`${C.vars['island_browser_api_key']}`"
        - name: Content-Type
          value: "'application/json'"
      collectRequestParams:
        - name: LastSeen
          value: "`${new Date(state.latestTime || earliest || (Date.now() -
            (1000*3600*24*7))).toISOString()}`"
      collectBody: |-
        JSON.stringify({"Limit": 100,
        "SortBy":"LastSeen",
        "SortDirection":"Asc"})
    destructive: false
    encoding: utf8
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    metadata:
      - name: __packsource
        value: "'cribl-island-browser-rest-io.devices'"
      - name: sourcetype
        value: "'island:browser:devices'"
    breakerRulesets:
      - Island Browser API Ruleset
  savedState: {}
  notifications: []
in_island_browser_users:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: 11 13 * * *
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: 60m
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking: {}
    enabled: true
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
      collectMethod: get
      pagination:
        type: request_offset
        offsetField: offset
        limitField: limit
        limit: 100
        maxPages: 50
        zeroIndexed: false
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: false
      decodeUrl: false
      rejectUnauthorized: true
      captureHeaders: false
      stopOnEmptyResults: true
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      collectUrl: "`${C.vars['island_browser_api_base_url']}/external/v1/users`"
      collectRequestHeaders:
        - name: Api-Key
          value: "`${C.vars['island_browser_api_key']}`"
      collectRequestParams:
        - name: SortBy
          value: "'CreatedDate'"
        - name: SortDirection
          value: "'Asc'"
      collectBody: "'{\"Limit\":100,\"Offset\":0,\"SortBy\":\"LastSeen\",\"SortDirect\
        ion\":\"Asc\"}'"
    destructive: false
    encoding: utf8
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    metadata:
      - name: __packsource
        value: "'cribl-island-browser-rest-io.users'"
      - name: sourcetype
        value: "'island:browser:users'"
    breakerRulesets:
      - Island Browser API Ruleset
  savedState: {}
  notifications: []
in_island_browser_compromised_credentials:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: "*/15 * * * *"
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: 60m
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking:
        stateUpdateExpression: "__timestampExtracted !== false && {latestTime:
          (state.latestTime || 0) > _time ? state.latestTime : _time}"
        stateMergeExpression: "(prevState.latestTime || 0) > newState.latestTime ?
          prevState : newState"
        enabled: true
    enabled: false
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
      collectMethod: post_with_body
      pagination:
        type: request_offset
        offsetField: offset
        limitField: limit
        limit: 100
        maxPages: 50
        zeroIndexed: false
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: false
      decodeUrl: false
      rejectUnauthorized: true
      captureHeaders: false
      stopOnEmptyResults: true
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      collectUrl: "`${C.vars['island_browser_api_base_url']}/external/v1/compromised-\
        credentials`"
      collectRequestHeaders:
        - name: Api-Key
          value: "`${C.vars['island_browser_api_key']}`"
        - name: Content-Type
          value: "'application/json'"
      collectRequestParams:
        - name: start
          value: "`${new Date(state.latestTime || earliest || (Date.now() -
            (1000*3600*24*7))).toISOString()}`"
        - name: end
          value: "`${new Date(Date.now()).toISOString()}`"
      collectBody: |-
        JSON.stringify({
        "start": `${new Date(state.latestTime*1000 || earliest*1000 || (Date.now() - (1000*3600*24*60))).toISOString()}`,
        "end": `${new Date(Date.now()).toISOString()}`,
        "limit": 100
        })
    destructive: false
    encoding: utf8
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    metadata:
      - name: __packsource
        value: "'cribl-island-browser-rest-io.compromised_credentials'"
      - name: sourcetype
        value: "'island:browser:compromised_credentials'"
    breakerRulesets:
      - Island Browser API Ruleset
  savedState: {}
  notifications: []
  description: Pagination not working - pulling 100 every run
in_island_browser_admin_actions:
  type: collection
  ttl: 4h
  ignoreGroupJobsLimit: false
  removeFields: []
  resumeOnBoot: false
  schedule:
    cronSchedule: "*/5 * * * *"
    maxConcurrentRuns: 1
    skippable: true
    run:
      rescheduleDroppedTasks: true
      maxTaskReschedule: 1
      logLevel: info
      jobTimeout: 60m
      mode: run
      timeRangeType: relative
      timeWarning: {}
      expression: "true"
      minTaskSize: 1MB
      maxTaskSize: 10MB
      stateTracking:
        stateUpdateExpression: "__timestampExtracted !== false && {latestTime:
          (state.latestTime || 0) > _time ? state.latestTime : _time}"
        stateMergeExpression: "(prevState.latestTime || 0) > newState.latestTime ?
          prevState : newState"
        enabled: true
    enabled: true
  streamtags: []
  workerAffinity: false
  collector:
    conf:
      discovery:
        discoverType: none
      collectMethod: get
      pagination:
        type: request_offset
        offsetField: offset
        limitField: limit
        limit: 100
        maxPages: 50
        zeroIndexed: false
      authentication: none
      timeout: 0
      useRoundRobinDns: false
      disableTimeFilter: false
      decodeUrl: false
      rejectUnauthorized: true
      captureHeaders: false
      stopOnEmptyResults: true
      safeHeaders: []
      retryRules:
        type: backoff
        interval: 1000
        limit: 5
        multiplier: 2
        maxIntervalMs: 20000
        codes:
          - 429
          - 503
        enableHeader: true
        retryConnectTimeout: false
        retryConnectReset: false
        retryHeaderName: retry-after
      __scheduling:
        stateTracking: {}
      collectUrl: "`${C.vars['island_browser_api_base_url']}/external/v1/adminActions`"
      collectRequestHeaders:
        - name: Api-Key
          value: "`${C.vars['island_browser_api_key']}`"
      collectRequestParams:
        - name: Start
          value: "`${new Date(state.latestTime*1000 || earliest*1000 || (Date.now() -
            (1000*3600*24*7))).toISOString()}`"
        - name: End
          value: "`${new Date(Date.now()).toISOString()}`"
    destructive: false
    encoding: utf8
    type: rest
  input:
    type: collection
    staleChannelFlushMs: 10000
    sendToRoutes: true
    preprocess:
      disabled: true
    throttleRatePerSec: "0"
    metadata:
      - name: __packsource
        value: "`'cribl-island-browser-rest-io.adminActions'`"
      - name: sourcetype
        value: "'island:browser:adminActions'"
    breakerRulesets:
      - Island Browser API Ruleset
  savedState: {}
  notifications: []
